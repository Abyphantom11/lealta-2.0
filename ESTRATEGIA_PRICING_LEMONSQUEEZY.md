# ğŸ’° ESTRATEGIA DE PRICING Y PLAN LEMON SQUEEZY

## ğŸ¯ ANÃLISIS DE MERCADO Y PRICING

### ğŸ“Š **Comparativa de Competencia**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SERVICIO          PRECIO/MES    LO QUE INCLUYE                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Square POS        $60-299/mes   Solo POS + Pagos               â”‚
â”‚  Zendesk CRM       $55-115/mes   Solo CRM                       â”‚
â”‚  OpenTable         $249-449/mes  Solo Reservas                  â”‚
â”‚  Toast POS         $165/mes      POS + Inventario               â”‚
â”‚  Lightspeed        $69-399/mes   POS + Analytics                â”‚
â”‚  Loyalty Lion      $399/mes      Solo FidelizaciÃ³n              â”‚
â”‚  Shopify POS       $89/mes       E-commerce + POS               â”‚
â”‚  Mailchimp         $350/mes      Marketing + CRM                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’° PROMEDIO COMPETENCIA: $150-400/mes por servicio individual
ğŸ“Š COMBINACIÃ“N 3+ SERVICIOS: $500-1,200/mes
```

### ğŸ† **TU PROPUESTA DE VALOR**

```
LEALTA 2.0 - TODO EN UNO
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… CRM Completo ($55-115/mes)                          â”‚
â”‚  âœ… POS con IA OCR ($165/mes)                           â”‚
â”‚  âœ… Sistema de Reservas IA ($249/mes)                   â”‚
â”‚  âœ… Loyalty Program ($399/mes)                          â”‚
â”‚  âœ… Portal Cliente PWA ($89/mes)                        â”‚
â”‚  âœ… Analytics & BI ($99/mes)                            â”‚
â”‚  âœ… MenÃº Digital ($49/mes)                              â”‚
â”‚  âœ… QR Management ($29/mes)                             â”‚
â”‚  âœ… Staff Management ($79/mes)                          â”‚
â”‚  âœ… Notificaciones Push (Incluido)                      â”‚
â”‚  âœ… Multi-tenant (Incluido)                             â”‚
â”‚  âœ… Soporte tÃ©cnico (Incluido)                          â”‚
â”‚  âœ… Updates constantes (Incluido)                       â”‚
â”‚  âœ… Setup inicial (Incluido)                            â”‚
â”‚  âœ… Training (Incluido)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’µ VALOR MERCADO: $1,200-1,500/mes                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’ **ESTRATEGIA DE PRICING RECOMENDADA**

### ğŸ¯ **PLAN ÃšNICO: LEALTA PRO**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           LEALTA PRO - ALL-IN-ONE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  ğŸ’° $299/mes USD (Pago Mensual)                       â”‚
â”‚  ğŸ’ $2,690/aÃ±o USD (Pago Anual - 25% OFF)             â”‚
â”‚     â†’ Ahorro: $898/aÃ±o                                â”‚
â”‚     â†’ Equivalente: $224/mes                           â”‚
â”‚                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… INCLUYE TODO:                                     â”‚
â”‚     â€¢ 15+ MÃ³dulos integrados                          â”‚
â”‚     â€¢ Usuarios staff ilimitados                       â”‚
â”‚     â€¢ Clientes ilimitados                             â”‚
â”‚     â€¢ Transacciones ilimitadas                        â”‚
â”‚     â€¢ Almacenamiento 50GB                             â”‚
â”‚     â€¢ Soporte prioritario (24-48h)                    â”‚
â”‚     â€¢ Training inicial incluido                       â”‚
â”‚     â€¢ Onboarding personalizado                        â”‚
â”‚     â€¢ Updates automÃ¡ticos                             â”‚
â”‚     â€¢ Backup diario                                   â”‚
â”‚     â€¢ SSL y seguridad incluida                        â”‚
â”‚     â€¢ Dominio personalizado                           â”‚
â”‚                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ BONOS:                                            â”‚
â”‚     â€¢ Setup inicial gratis ($500 valor)               â”‚
â”‚     â€¢ PersonalizaciÃ³n de branding incluida            â”‚
â”‚     â€¢ MigraciÃ³n de datos (si aplica)                  â”‚
â”‚     â€¢ 30 dÃ­as garantÃ­a de devoluciÃ³n                  â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š **Por quÃ© $299/mes es el Sweet Spot:**

```
âœ… PSICOLOGÃA DE PRECIO:
   â€¢ Debajo de $300 = "Accesible" mentalmente
   â€¢ Equivalente a 2-3 empleados/dÃ­a en costos operativos
   â€¢ ROI visible en 2-3 meses

âœ… POSICIONAMIENTO:
   â€¢ No compites con soluciones baratas ($49/mes)
   â€¢ No asustas como enterprise ($999/mes)
   â€¢ Premium pero accesible para SMB

âœ… COMPARATIVA:
   â€¢ Competencia: $500-1,200/mes (mÃºltiples servicios)
   â€¢ TÃº: $299/mes (todo incluido)
   â€¢ Ahorro cliente: 60-75%

âœ… MARGEN SALUDABLE:
   â€¢ Costos infraestructura: ~$50-80/negocio/mes
   â€¢ Margen: ~$220/negocio/mes
   â€¢ 5 clientes: $1,495/mes ingreso ($1,100 neto)
   â€¢ 15 clientes: $4,485/mes ingreso ($3,300 neto)
```

---

## ğŸ“ˆ **PROYECCIÃ“N DE INGRESOS (5-15 NEGOCIOS)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ESCENARIO         MRR        ARR       NETO MENSUAL         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  5 negocios     $1,495    $17,940      ~$1,100/mes          â”‚
â”‚  8 negocios     $2,392    $28,704      ~$1,760/mes          â”‚
â”‚  10 negocios    $2,990    $35,880      ~$2,200/mes          â”‚
â”‚  15 negocios    $4,485    $53,820      ~$3,300/mes          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ Con 10 clientes = $2,200/mes neto
   â†’ Ingreso sÃ³lido para 1-2 personas
   â†’ Permite reinvertir en desarrollo
   â†’ Suficiente para crecer orgÃ¡nicamente

ğŸ¯ OBJETIVO: Conseguir 10 clientes en 6 meses
   â†’ Marketing: $500/mes
   â†’ Soporte: 1-2 horas/dÃ­a
   â†’ Desarrollo: 3-4 horas/dÃ­a
```

---

## ğŸ‹ **PLAN DE IMPLEMENTACIÃ“N LEMON SQUEEZY**

### ğŸ¯ **FASE 1: SETUP INICIAL (DÃ­a 1-2)**

#### **1.1 Crear Cuenta Lemon Squeezy**
```bash
âœ… Pasos:
1. Ir a https://lemonsqueezy.com
2. Sign up con GitHub/Google
3. Completar perfil de negocio
4. Configurar informaciÃ³n fiscal
5. Conectar cuenta bancaria/Stripe
```

#### **1.2 Crear Producto en Lemon Squeezy**
```javascript
Producto: Lealta Pro - All-in-One Business Platform

ConfiguraciÃ³n:
- Nombre: "Lealta Pro"
- DescripciÃ³n: "Sistema completo de gestiÃ³n, fidelizaciÃ³n y reservas 
  con IA para restaurantes y negocios"
- Tipo: Subscription (Recurrente)
- Precio Mensual: $299 USD
- Precio Anual: $2,690 USD (25% descuento)
- Trial: 14 dÃ­as gratis (recomendado)
- Impuestos: AutomÃ¡tico por regiÃ³n
```

#### **1.3 Configurar Webhooks**
```javascript
Webhooks necesarios:
âœ… subscription_created    â†’ Activar cuenta negocio
âœ… subscription_updated    â†’ Actualizar plan
âœ… subscription_cancelled  â†’ Pausar cuenta
âœ… subscription_resumed    â†’ Reactivar cuenta
âœ… subscription_expired    â†’ Bloquear acceso
âœ… order_created          â†’ NotificaciÃ³n nueva venta
âœ… order_refunded         â†’ Procesar reembolso
```

---

### ğŸ¯ **FASE 2: INTEGRACIÃ“N TÃ‰CNICA (DÃ­a 3-5)**

#### **2.1 Instalar Dependencies**
```bash
npm install @lemonsqueezy/lemonsqueezy.js
npm install @lemonsqueezy/paddle-js # Para checkout embebido
```

#### **2.2 Configurar Variables de Entorno**
```bash
# .env.local
LEMONSQUEEZY_API_KEY=your_api_key
LEMONSQUEEZY_STORE_ID=your_store_id
LEMONSQUEEZY_PRODUCT_ID=your_product_id
LEMONSQUEEZY_WEBHOOK_SECRET=your_webhook_secret
```

#### **2.3 Crear API Route para Webhooks**
```typescript
// src/app/api/webhooks/lemonsqueezy/route.ts
import { NextRequest, NextResponse } from 'next/server';
import crypto from 'crypto';
import { prisma } from '@/lib/prisma';

export async function POST(request: NextRequest) {
  try {
    const body = await request.text();
    const signature = request.headers.get('x-signature');

    // Verificar webhook signature
    const isValid = verifyWebhookSignature(body, signature);
    if (!isValid) {
      return NextResponse.json({ error: 'Invalid signature' }, { status: 401 });
    }

    const event = JSON.parse(body);
    const { meta, data } = event;

    console.log('ğŸ‹ Webhook recibido:', meta.event_name);

    switch (meta.event_name) {
      case 'subscription_created':
        await handleSubscriptionCreated(data);
        break;

      case 'subscription_updated':
        await handleSubscriptionUpdated(data);
        break;

      case 'subscription_cancelled':
        await handleSubscriptionCancelled(data);
        break;

      case 'subscription_expired':
        await handleSubscriptionExpired(data);
        break;

      case 'order_created':
        await handleOrderCreated(data);
        break;

      default:
        console.log('Evento no manejado:', meta.event_name);
    }

    return NextResponse.json({ received: true });
  } catch (error) {
    console.error('Error procesando webhook:', error);
    return NextResponse.json({ error: 'Webhook error' }, { status: 500 });
  }
}

function verifyWebhookSignature(body: string, signature: string | null): boolean {
  if (!signature) return false;

  const secret = process.env.LEMONSQUEEZY_WEBHOOK_SECRET!;
  const hash = crypto
    .createHmac('sha256', secret)
    .update(body)
    .digest('hex');

  return hash === signature;
}

async function handleSubscriptionCreated(data: any) {
  const { attributes, id } = data;
  const customerId = attributes.customer_id;
  const businessId = attributes.custom_data?.businessId;

  // Actualizar base de datos
  await prisma.business.update({
    where: { id: businessId },
    data: {
      subscriptionStatus: 'ACTIVE',
      subscriptionId: id,
      customerId: customerId,
      plan: 'PRO',
      subscriptionStartDate: new Date(attributes.created_at),
      subscriptionEndDate: new Date(attributes.renews_at),
    },
  });

  console.log('âœ… SuscripciÃ³n activada para negocio:', businessId);
}

async function handleSubscriptionUpdated(data: any) {
  const { attributes, id } = data;
  
  await prisma.business.update({
    where: { subscriptionId: id },
    data: {
      subscriptionStatus: attributes.status.toUpperCase(),
      subscriptionEndDate: new Date(attributes.renews_at),
    },
  });
}

async function handleSubscriptionCancelled(data: any) {
  const { id } = data;
  
  await prisma.business.update({
    where: { subscriptionId: id },
    data: {
      subscriptionStatus: 'CANCELLED',
      // Dar 30 dÃ­as de gracia antes de desactivar
      subscriptionGracePeriodEnd: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),
    },
  });
}

async function handleSubscriptionExpired(data: any) {
  const { id } = data;
  
  await prisma.business.update({
    where: { subscriptionId: id },
    data: {
      subscriptionStatus: 'EXPIRED',
      isActive: false,
    },
  });
}

async function handleOrderCreated(data: any) {
  // Log para analytics
  console.log('ğŸ‰ Nueva venta:', data.attributes.total_formatted);
  
  // Enviar notificaciÃ³n a Slack/Email
  // await notifyNewSale(data);
}
```

#### **2.4 Actualizar Schema Prisma**
```prisma
// prisma/schema.prisma

model Business {
  id               String   @id @default(cuid())
  name             String
  slug             String   @unique
  
  // ... campos existentes ...
  
  // ğŸ‹ Lemon Squeezy Integration
  subscriptionStatus      SubscriptionStatus @default(TRIAL)
  subscriptionId          String?   @unique
  customerId              String?
  plan                    String?   @default("TRIAL")
  subscriptionStartDate   DateTime?
  subscriptionEndDate     DateTime?
  subscriptionGracePeriodEnd DateTime?
  
  // Features enabled (para future-proofing)
  enabledModules          String[]  @default(["all"])
  
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

enum SubscriptionStatus {
  TRIAL
  ACTIVE
  PAST_DUE
  CANCELLED
  EXPIRED
  PAUSED
}
```

#### **2.5 Crear PÃ¡gina de Pricing**
```typescript
// src/app/pricing/page.tsx
'use client';

import { useState } from 'react';
import { Check, Zap } from 'lucide-react';
import { Button } from '@/components/ui/button';

export default function PricingPage() {
  const [billingCycle, setBillingCycle] = useState<'monthly' | 'yearly'>('monthly');

  const handleCheckout = async (cycle: 'monthly' | 'yearly') => {
    const checkoutUrl = cycle === 'monthly' 
      ? process.env.NEXT_PUBLIC_LEMONSQUEEZY_CHECKOUT_MONTHLY
      : process.env.NEXT_PUBLIC_LEMONSQUEEZY_CHECKOUT_YEARLY;

    // Redirigir a Lemon Squeezy checkout
    window.location.href = checkoutUrl!;
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 py-20">
      <div className="max-w-7xl mx-auto px-4">
        {/* Header */}
        <div className="text-center mb-16">
          <h1 className="text-5xl font-bold text-white mb-4">
            Simple, Transparente, Todo Incluido
          </h1>
          <p className="text-xl text-gray-300 mb-8">
            Un solo plan. Todos los mÃ³dulos. Sin sorpresas.
          </p>

          {/* Toggle Billing */}
          <div className="flex items-center justify-center gap-4">
            <span className={`text-lg ${billingCycle === 'monthly' ? 'text-white font-semibold' : 'text-gray-400'}`}>
              Mensual
            </span>
            <button
              onClick={() => setBillingCycle(billingCycle === 'monthly' ? 'yearly' : 'monthly')}
              className="relative w-16 h-8 bg-purple-600 rounded-full transition-colors"
            >
              <div className={`absolute top-1 w-6 h-6 bg-white rounded-full transition-transform ${
                billingCycle === 'yearly' ? 'translate-x-9' : 'translate-x-1'
              }`} />
            </button>
            <span className={`text-lg ${billingCycle === 'yearly' ? 'text-white font-semibold' : 'text-gray-400'}`}>
              Anual
              <span className="ml-2 px-2 py-1 bg-green-500 text-white text-xs rounded-full">
                Ahorra 25%
              </span>
            </span>
          </div>
        </div>

        {/* Pricing Card */}
        <div className="max-w-2xl mx-auto">
          <div className="bg-white rounded-2xl shadow-2xl p-8 border-4 border-purple-500">
            {/* Badge */}
            <div className="flex items-center justify-between mb-6">
              <div>
                <h2 className="text-3xl font-bold text-gray-900">Lealta Pro</h2>
                <p className="text-gray-600">Todo lo que necesitas para crecer</p>
              </div>
              <div className="bg-purple-100 text-purple-700 px-4 py-2 rounded-lg font-semibold">
                <Zap className="inline h-5 w-5 mr-1" />
                Popular
              </div>
            </div>

            {/* Price */}
            <div className="mb-8">
              <div className="flex items-baseline gap-2">
                <span className="text-6xl font-bold text-gray-900">
                  ${billingCycle === 'monthly' ? '299' : '224'}
                </span>
                <span className="text-2xl text-gray-600">/mes</span>
              </div>
              {billingCycle === 'yearly' && (
                <p className="text-green-600 font-semibold mt-2">
                  $2,690 facturado anualmente - Ahorras $898/aÃ±o
                </p>
              )}
            </div>

            {/* Features */}
            <div className="space-y-4 mb-8">
              <h3 className="font-bold text-lg text-gray-900 mb-4">Todo incluido:</h3>
              
              <FeatureItem text="15+ MÃ³dulos integrados (CRM, POS, Reservas IA, Analytics)" />
              <FeatureItem text="Usuarios staff ilimitados" />
              <FeatureItem text="Clientes ilimitados" />
              <FeatureItem text="Transacciones ilimitadas" />
              <FeatureItem text="Almacenamiento 50GB" />
              <FeatureItem text="Portal Cliente personalizado (PWA)" />
              <FeatureItem text="Sistema de FidelizaciÃ³n completo" />
              <FeatureItem text="Reservas con IA (Gemini 2.0)" />
              <FeatureItem text="POS con OCR automÃ¡tico" />
              <FeatureItem text="Analytics en tiempo real" />
              <FeatureItem text="Notificaciones Push" />
              <FeatureItem text="QR Code Management" />
              <FeatureItem text="Soporte prioritario (24-48h)" />
              <FeatureItem text="Training inicial incluido" />
              <FeatureItem text="Updates automÃ¡ticos" />
              <FeatureItem text="Backup diario" />
              <FeatureItem text="SSL y seguridad incluida" />
              <FeatureItem text="Dominio personalizado" />
            </div>

            {/* Bonos */}
            <div className="bg-purple-50 rounded-lg p-6 mb-8">
              <h4 className="font-bold text-purple-900 mb-3 flex items-center gap-2">
                ğŸ Bonos Incluidos (Valor $500+)
              </h4>
              <ul className="space-y-2 text-purple-800">
                <li>âœ¨ Setup inicial completamente gratis</li>
                <li>ğŸ¨ PersonalizaciÃ³n de branding incluida</li>
                <li>ğŸ“¦ MigraciÃ³n de datos (si aplica)</li>
                <li>ğŸ›¡ï¸ 30 dÃ­as garantÃ­a de devoluciÃ³n</li>
              </ul>
            </div>

            {/* CTA Button */}
            <Button
              onClick={() => handleCheckout(billingCycle)}
              className="w-full bg-purple-600 hover:bg-purple-700 text-white text-lg py-6 rounded-xl"
            >
              Comenzar ahora - 14 dÃ­as gratis
            </Button>

            <p className="text-center text-sm text-gray-500 mt-4">
              No requiere tarjeta de crÃ©dito para el trial
            </p>
          </div>
        </div>

        {/* Comparativa Valor */}
        <div className="max-w-4xl mx-auto mt-16">
          <div className="bg-white/10 backdrop-blur-lg rounded-xl p-8">
            <h3 className="text-2xl font-bold text-white text-center mb-6">
              ğŸ’° Comparativa de Valor
            </h3>
            <div className="grid md:grid-cols-2 gap-8 text-white">
              <div>
                <h4 className="font-semibold mb-4 text-red-300">âŒ Soluciones Separadas:</h4>
                <ul className="space-y-2 text-sm">
                  <li>Square POS: $165/mes</li>
                  <li>OpenTable: $249/mes</li>
                  <li>Loyalty Lion: $399/mes</li>
                  <li>Zendesk: $115/mes</li>
                  <li>Analytics: $99/mes</li>
                  <li className="pt-2 border-t border-white/20 font-bold text-lg">
                    Total: $1,027/mes
                  </li>
                </ul>
              </div>
              <div>
                <h4 className="font-semibold mb-4 text-green-300">âœ… Lealta Pro:</h4>
                <ul className="space-y-2 text-sm">
                  <li>âœ… Todo lo anterior</li>
                  <li>âœ… + IA integrada</li>
                  <li>âœ… + Portal cliente</li>
                  <li>âœ… + QR Management</li>
                  <li>âœ… + Soporte incluido</li>
                  <li className="pt-2 border-t border-white/20 font-bold text-lg text-green-400">
                    Total: $299/mes
                  </li>
                </ul>
              </div>
            </div>
            <p className="text-center text-2xl font-bold text-green-400 mt-6">
              Ahorras $728/mes (71% de descuento)
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}

function FeatureItem({ text }: { text: string }) {
  return (
    <div className="flex items-start gap-3">
      <Check className="h-6 w-6 text-green-500 flex-shrink-0" />
      <span className="text-gray-700">{text}</span>
    </div>
  );
}
```

---

### ğŸ¯ **FASE 3: MIDDLEWARE DE SUSCRIPCIÃ“N (DÃ­a 6-7)**

#### **3.1 Crear Middleware de ValidaciÃ³n**
```typescript
// src/middleware/subscriptionGuard.ts
import { NextRequest, NextResponse } from 'next/server';
import { prisma } from '@/lib/prisma';

export async function subscriptionGuard(
  request: NextRequest,
  businessId: string
): Promise<NextResponse | null> {
  try {
    const business = await prisma.business.findUnique({
      where: { id: businessId },
      select: {
        subscriptionStatus: true,
        subscriptionEndDate: true,
        subscriptionGracePeriodEnd: true,
      },
    });

    if (!business) {
      return NextResponse.json(
        { error: 'Negocio no encontrado' },
        { status: 404 }
      );
    }

    // Verificar estado de suscripciÃ³n
    const now = new Date();

    switch (business.subscriptionStatus) {
      case 'TRIAL':
        // Verificar si trial expirÃ³
        if (business.subscriptionEndDate && business.subscriptionEndDate < now) {
          return NextResponse.json(
            {
              error: 'Trial expirado',
              message: 'Tu perÃ­odo de prueba ha terminado. Por favor suscrÃ­bete para continuar.',
              redirectTo: '/pricing',
            },
            { status: 402 }
          );
        }
        break;

      case 'ACTIVE':
        // Todo OK
        break;

      case 'PAST_DUE':
        // Mostrar banner pero permitir uso limitado
        console.warn('âš ï¸ SuscripciÃ³n vencida para:', businessId);
        break;

      case 'CANCELLED':
        // Verificar si estÃ¡ en grace period
        if (business.subscriptionGracePeriodEnd && business.subscriptionGracePeriodEnd < now) {
          return NextResponse.json(
            {
              error: 'SuscripciÃ³n cancelada',
              message: 'Tu suscripciÃ³n ha sido cancelada. Renueva para continuar.',
              redirectTo: '/pricing',
            },
            { status: 402 }
          );
        }
        break;

      case 'EXPIRED':
        return NextResponse.json(
          {
            error: 'SuscripciÃ³n expirada',
            message: 'Tu suscripciÃ³n ha expirado. Por favor renueva tu plan.',
            redirectTo: '/pricing',
          },
          { status: 402 }
        );

      default:
        break;
    }

    return null; // No hay error, continuar
  } catch (error) {
    console.error('Error en subscriptionGuard:', error);
    return NextResponse.json(
      { error: 'Error validando suscripciÃ³n' },
      { status: 500 }
    );
  }
}
```

#### **3.2 Integrar en APIs CrÃ­ticas**
```typescript
// src/app/api/reservas/create/route.ts
import { subscriptionGuard } from '@/middleware/subscriptionGuard';

export async function POST(request: NextRequest) {
  return withAuth(request, async (session) => {
    // Validar suscripciÃ³n
    const subscriptionError = await subscriptionGuard(request, session.businessId);
    if (subscriptionError) return subscriptionError;

    // Continuar con lÃ³gica normal...
  });
}
```

---

### ğŸ¯ **FASE 4: DASHBOARD DE SUSCRIPCIÃ“N (DÃ­a 8-9)**

#### **4.1 Crear PÃ¡gina de Billing en Admin**
```typescript
// src/app/[businessId]/admin/billing/page.tsx
'use client';

import { useEffect, useState } from 'react';
import { CreditCard, Calendar, AlertCircle, CheckCircle } from 'lucide-react';
import { Button } from '@/components/ui/button';

interface SubscriptionData {
  status: string;
  plan: string;
  startDate: string;
  endDate: string;
  customerId: string;
}

export default function BillingPage({ params }: { params: { businessId: string } }) {
  const [subscription, setSubscription] = useState<SubscriptionData | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchSubscription();
  }, []);

  const fetchSubscription = async () => {
    try {
      const res = await fetch(`/api/business/${params.businessId}/subscription`);
      const data = await res.json();
      setSubscription(data.subscription);
    } catch (error) {
      console.error('Error fetching subscription:', error);
    } finally {
      setLoading(false);
    }
  };

  const handleManageBilling = () => {
    // Redirigir a Lemon Squeezy customer portal
    window.open(
      `https://app.lemonsqueezy.com/my-orders/customer-portal/${subscription?.customerId}`,
      '_blank'
    );
  };

  const getStatusBadge = (status: string) => {
    const badges = {
      ACTIVE: { text: 'Activa', className: 'bg-green-100 text-green-800', icon: CheckCircle },
      TRIAL: { text: 'Prueba', className: 'bg-blue-100 text-blue-800', icon: AlertCircle },
      CANCELLED: { text: 'Cancelada', className: 'bg-red-100 text-red-800', icon: AlertCircle },
      EXPIRED: { text: 'Expirada', className: 'bg-gray-100 text-gray-800', icon: AlertCircle },
      PAST_DUE: { text: 'Vencida', className: 'bg-yellow-100 text-yellow-800', icon: AlertCircle },
    };

    const badge = badges[status as keyof typeof badges] || badges.ACTIVE;
    const Icon = badge.icon;

    return (
      <span className={`px-3 py-1 rounded-full text-sm font-semibold inline-flex items-center gap-2 ${badge.className}`}>
        <Icon className="h-4 w-4" />
        {badge.text}
      </span>
    );
  };

  if (loading) {
    return <div className="p-8">Cargando...</div>;
  }

  return (
    <div className="max-w-4xl mx-auto p-8">
      <h1 className="text-3xl font-bold mb-8">FacturaciÃ³n y SuscripciÃ³n</h1>

      {/* Subscription Status Card */}
      <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
        <div className="flex items-center justify-between mb-6">
          <div>
            <h2 className="text-xl font-semibold mb-2">Estado de SuscripciÃ³n</h2>
            {getStatusBadge(subscription?.status || 'ACTIVE')}
          </div>
          <CreditCard className="h-12 w-12 text-purple-600" />
        </div>

        <div className="grid grid-cols-2 gap-6">
          <div>
            <p className="text-sm text-gray-600 mb-1">Plan Actual</p>
            <p className="text-lg font-semibold">{subscription?.plan || 'Lealta Pro'}</p>
          </div>
          <div>
            <p className="text-sm text-gray-600 mb-1">Precio</p>
            <p className="text-lg font-semibold">$299/mes</p>
          </div>
          <div>
            <p className="text-sm text-gray-600 mb-1">Fecha de Inicio</p>
            <p className="text-lg font-semibold">
              {subscription?.startDate ? new Date(subscription.startDate).toLocaleDateString() : '-'}
            </p>
          </div>
          <div>
            <p className="text-sm text-gray-600 mb-1 flex items-center gap-2">
              <Calendar className="h-4 w-4" />
              PrÃ³xima RenovaciÃ³n
            </p>
            <p className="text-lg font-semibold">
              {subscription?.endDate ? new Date(subscription.endDate).toLocaleDateString() : '-'}
            </p>
          </div>
        </div>

        <div className="mt-6 pt-6 border-t">
          <Button
            onClick={handleManageBilling}
            className="w-full bg-purple-600 hover:bg-purple-700"
          >
            Gestionar SuscripciÃ³n
          </Button>
          <p className="text-xs text-gray-500 text-center mt-2">
            Actualiza tu mÃ©todo de pago, descarga facturas o cancela tu suscripciÃ³n
          </p>
        </div>
      </div>

      {/* Features Included */}
      <div className="bg-gray-50 rounded-lg p-6">
        <h3 className="font-semibold mb-4">Incluido en tu plan:</h3>
        <div className="grid grid-cols-2 gap-3 text-sm">
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>15+ MÃ³dulos integrados</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Staff ilimitado</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Clientes ilimitados</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Soporte prioritario</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Updates automÃ¡ticos</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Almacenamiento 50GB</span>
          </div>
        </div>
      </div>
    </div>
  );
}
```

---

## ğŸš€ **PLAN DE ACCIÃ“N COMPLETO**

### ğŸ“… **Timeline de ImplementaciÃ³n**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DÃA 1-2: Setup Lemon Squeezy                              â”‚
â”‚  âœ… Crear cuenta                                           â”‚
â”‚  âœ… Configurar producto                                    â”‚
â”‚  âœ… Configurar webhooks                                    â”‚
â”‚  âœ… Obtener API keys                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DÃA 3-5: IntegraciÃ³n Backend                              â”‚
â”‚  âœ… Instalar dependencias                                  â”‚
â”‚  âœ… Crear webhook endpoint                                 â”‚
â”‚  âœ… Actualizar schema Prisma                               â”‚
â”‚  âœ… Migrar database                                        â”‚
â”‚  âœ… Testing webhooks                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DÃA 6-7: Middleware & Guards                              â”‚
â”‚  âœ… Crear subscription guard                               â”‚
â”‚  âœ… Integrar en APIs crÃ­ticas                              â”‚
â”‚  âœ… Testing de bloqueos                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DÃA 8-9: Frontend                                         â”‚
â”‚  âœ… PÃ¡gina de pricing                                      â”‚
â”‚  âœ… PÃ¡gina de billing en admin                             â”‚
â”‚  âœ… Banners de suscripciÃ³n                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DÃA 10: Testing E2E                                       â”‚
â”‚  âœ… Test de checkout completo                              â”‚
â”‚  âœ… Test de webhooks                                       â”‚
â”‚  âœ… Test de restricciones                                  â”‚
â”‚  âœ… Test de renovaciÃ³n                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DÃA 11-12: Deploy & Launch                               â”‚
â”‚  âœ… Deploy a producciÃ³n                                    â”‚
â”‚  âœ… Configurar webhooks producciÃ³n                         â”‚
â”‚  âœ… Testing en producciÃ³n                                  â”‚
â”‚  âœ… Lanzamiento soft                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â±ï¸ TOTAL: 12 dÃ­as hasta lanzamiento
```

---

## ğŸ’¼ **ESTRATEGIA DE GO-TO-MARKET**

### ğŸ¯ **Primeros 5 Clientes (Mes 1-2)**

```
ESTRATEGIA: Lanzamiento con Early Adopters

1. ğŸ OFERTA LAUNCH (Primeros 5 clientes):
   â€¢ $199/mes por 3 meses (33% OFF)
   â€¢ DespuÃ©s $299/mes
   â€¢ Setup premium incluido
   â€¢ MigraciÃ³n de datos gratis
   â€¢ Onboarding 1-a-1 dedicado

2. ğŸ¯ TARGET:
   â€¢ Restaurantes pequeÃ±os-medianos
   â€¢ CafeterÃ­as con 2+ sucursales
   â€¢ Negocios con programa de fidelidad manual
   â€¢ Tu red cercana de contactos

3. ğŸ“¢ CANALES:
   â€¢ LinkedIn outreach (tu perfil)
   â€¢ WhatsApp/Email directo
   â€¢ Referidos de primeros clientes
   â€¢ Demo en vivo (Zoom/presencial)
```

### ğŸ“ˆ **Clientes 6-15 (Mes 3-6)**

```
ESTRATEGIA: Crecimiento OrgÃ¡nico

1. ğŸ’¬ TESTIMONIOS:
   â€¢ Video testimonios clientes satisfechos
   â€¢ Case studies con mÃ©tricas reales
   â€¢ Logos de clientes en landing

2. ğŸ“Š CONTENT MARKETING:
   â€¢ LinkedIn posts 2x/semana
   â€¢ Blog posts sobre fidelizaciÃ³n
   â€¢ Tutoriales en YouTube

3. ğŸ¤ PARTNERSHIPS:
   â€¢ Alianza con consultores de restaurantes
   â€¢ Referidos con comisiÃ³n (10%)
   â€¢ Eventos locales de networking

4. ğŸ’° INVERSIÃ“N MARKETING:
   â€¢ Google Ads: $200/mes
   â€¢ LinkedIn Ads: $200/mes
   â€¢ Contenido: $100/mes
```

---

## ğŸ“Š **MÃ‰TRICAS DE Ã‰XITO**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MES 1-2:                                                â”‚
â”‚  ğŸ¯ 5 clientes pagando ($1,495 MRR)                     â”‚
â”‚  ğŸ“ˆ 50 demos realizados                                 â”‚
â”‚  ğŸ’° InversiÃ³n: $500 marketing                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MES 3-4:                                                â”‚
â”‚  ğŸ¯ 8 clientes pagando ($2,392 MRR)                     â”‚
â”‚  ğŸ“ˆ 80 demos realizados                                 â”‚
â”‚  ğŸ’° InversiÃ³n: $800 marketing                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MES 5-6:                                                â”‚
â”‚  ğŸ¯ 12 clientes pagando ($3,588 MRR)                    â”‚
â”‚  ğŸ“ˆ 120 demos realizados                                â”‚
â”‚  ğŸ’° InversiÃ³n: $1,000 marketing                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ† META 6 MESES:                                       â”‚
â”‚  âœ… 10-15 clientes                                      â”‚
â”‚  âœ… $3,000-4,500 MRR                                    â”‚
â”‚  âœ… Churn < 10%                                         â”‚
â”‚  âœ… NPS > 50                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ **CONCLUSIÃ“N Y RECOMENDACIÃ“N FINAL**

### ğŸ’° **Pricing Recomendado:**
```
âœ… $299/mes (Pago Mensual)
âœ… $2,690/aÃ±o ($224/mes - 25% OFF Anual)
âœ… 14 dÃ­as trial gratis
âœ… Sin setup fee
âœ… Un solo plan (Lealta Pro)
```

### ğŸ“‹ **Razones de este precio:**

1. **ğŸ¯ PsicolÃ³gico**: $299 vs $300 hace gran diferencia
2. **ğŸ’ª Valor percibido**: Comparado con $1,000+ en herramientas separadas
3. **ğŸ’° Margen saludable**: ~73% margen con 10 clientes
4. **ğŸš€ Escalable**: Sostenible desde 5 hasta 50 clientes
5. **ğŸ¤ Accesible**: SMB pueden pagarlo sin aprobaciones complejas

### âš¡ **Next Steps Inmediatos:**

```bash
1. [ ] Crear cuenta Lemon Squeezy (1 hora)
2. [ ] Configurar producto y pricing (2 horas)
3. [ ] Implementar webhooks backend (1 dÃ­a)
4. [ ] Crear pÃ¡gina de pricing (1 dÃ­a)
5. [ ] Testing completo (1 dÃ­a)
6. [ ] Soft launch con 3 contactos cercanos (1 semana)
7. [ ] Ajustar segÃºn feedback (ongoing)
8. [ ] Full launch pÃºblico (DÃ­a 14)
```

**Â¿Listo para implementar? Te ayudo con cualquier paso especÃ­fico.** ğŸš€
