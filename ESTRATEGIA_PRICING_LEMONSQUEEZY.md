# 💰 ESTRATEGIA DE PRICING Y PLAN LEMON SQUEEZY

## 🎯 ANÁLISIS DE MERCADO Y PRICING

### 📊 **Comparativa de Competencia**

```
┌─────────────────────────────────────────────────────────────────┐
│  SERVICIO          PRECIO/MES    LO QUE INCLUYE                 │
├─────────────────────────────────────────────────────────────────┤
│  Square POS        $60-299/mes   Solo POS + Pagos               │
│  Zendesk CRM       $55-115/mes   Solo CRM                       │
│  OpenTable         $249-449/mes  Solo Reservas                  │
│  Toast POS         $165/mes      POS + Inventario               │
│  Lightspeed        $69-399/mes   POS + Analytics                │
│  Loyalty Lion      $399/mes      Solo Fidelización              │
│  Shopify POS       $89/mes       E-commerce + POS               │
│  Mailchimp         $350/mes      Marketing + CRM                │
└─────────────────────────────────────────────────────────────────┘

💰 PROMEDIO COMPETENCIA: $150-400/mes por servicio individual
📊 COMBINACIÓN 3+ SERVICIOS: $500-1,200/mes
```

### 🏆 **TU PROPUESTA DE VALOR**

```
LEALTA 2.0 - TODO EN UNO
┌─────────────────────────────────────────────────────────┐
│  ✅ CRM Completo ($55-115/mes)                          │
│  ✅ POS con IA OCR ($165/mes)                           │
│  ✅ Sistema de Reservas IA ($249/mes)                   │
│  ✅ Loyalty Program ($399/mes)                          │
│  ✅ Portal Cliente PWA ($89/mes)                        │
│  ✅ Analytics & BI ($99/mes)                            │
│  ✅ Menú Digital ($49/mes)                              │
│  ✅ QR Management ($29/mes)                             │
│  ✅ Staff Management ($79/mes)                          │
│  ✅ Notificaciones Push (Incluido)                      │
│  ✅ Multi-tenant (Incluido)                             │
│  ✅ Soporte técnico (Incluido)                          │
│  ✅ Updates constantes (Incluido)                       │
│  ✅ Setup inicial (Incluido)                            │
│  ✅ Training (Incluido)                                 │
├─────────────────────────────────────────────────────────┤
│  💵 VALOR MERCADO: $1,200-1,500/mes                     │
└─────────────────────────────────────────────────────────┘
```

---

## 💎 **ESTRATEGIA DE PRICING RECOMENDADA**

### 🎯 **PLAN ÚNICO: LEALTA PRO**

```
┌────────────────────────────────────────────────────────┐
│           LEALTA PRO - ALL-IN-ONE                      │
├────────────────────────────────────────────────────────┤
│                                                        │
│  💰 $299/mes USD (Pago Mensual)                       │
│  💎 $2,690/año USD (Pago Anual - 25% OFF)             │
│     → Ahorro: $898/año                                │
│     → Equivalente: $224/mes                           │
│                                                        │
├────────────────────────────────────────────────────────┤
│  ✅ INCLUYE TODO:                                     │
│     • 15+ Módulos integrados                          │
│     • Usuarios staff ilimitados                       │
│     • Clientes ilimitados                             │
│     • Transacciones ilimitadas                        │
│     • Almacenamiento 50GB                             │
│     • Soporte prioritario (24-48h)                    │
│     • Training inicial incluido                       │
│     • Onboarding personalizado                        │
│     • Updates automáticos                             │
│     • Backup diario                                   │
│     • SSL y seguridad incluida                        │
│     • Dominio personalizado                           │
│                                                        │
├────────────────────────────────────────────────────────┤
│  🎁 BONOS:                                            │
│     • Setup inicial gratis ($500 valor)               │
│     • Personalización de branding incluida            │
│     • Migración de datos (si aplica)                  │
│     • 30 días garantía de devolución                  │
│                                                        │
└────────────────────────────────────────────────────────┘
```

### 📊 **Por qué $299/mes es el Sweet Spot:**

```
✅ PSICOLOGÍA DE PRECIO:
   • Debajo de $300 = "Accesible" mentalmente
   • Equivalente a 2-3 empleados/día en costos operativos
   • ROI visible en 2-3 meses

✅ POSICIONAMIENTO:
   • No compites con soluciones baratas ($49/mes)
   • No asustas como enterprise ($999/mes)
   • Premium pero accesible para SMB

✅ COMPARATIVA:
   • Competencia: $500-1,200/mes (múltiples servicios)
   • Tú: $299/mes (todo incluido)
   • Ahorro cliente: 60-75%

✅ MARGEN SALUDABLE:
   • Costos infraestructura: ~$50-80/negocio/mes
   • Margen: ~$220/negocio/mes
   • 5 clientes: $1,495/mes ingreso ($1,100 neto)
   • 15 clientes: $4,485/mes ingreso ($3,300 neto)
```

---

## 📈 **PROYECCIÓN DE INGRESOS (5-15 NEGOCIOS)**

```
┌──────────────────────────────────────────────────────────────┐
│  ESCENARIO         MRR        ARR       NETO MENSUAL         │
├──────────────────────────────────────────────────────────────┤
│  5 negocios     $1,495    $17,940      ~$1,100/mes          │
│  8 negocios     $2,392    $28,704      ~$1,760/mes          │
│  10 negocios    $2,990    $35,880      ~$2,200/mes          │
│  15 negocios    $4,485    $53,820      ~$3,300/mes          │
└──────────────────────────────────────────────────────────────┘

💡 Con 10 clientes = $2,200/mes neto
   → Ingreso sólido para 1-2 personas
   → Permite reinvertir en desarrollo
   → Suficiente para crecer orgánicamente

🎯 OBJETIVO: Conseguir 10 clientes en 6 meses
   → Marketing: $500/mes
   → Soporte: 1-2 horas/día
   → Desarrollo: 3-4 horas/día
```

---

## 🍋 **PLAN DE IMPLEMENTACIÓN LEMON SQUEEZY**

### 🎯 **FASE 1: SETUP INICIAL (Día 1-2)**

#### **1.1 Crear Cuenta Lemon Squeezy**
```bash
✅ Pasos:
1. Ir a https://lemonsqueezy.com
2. Sign up con GitHub/Google
3. Completar perfil de negocio
4. Configurar información fiscal
5. Conectar cuenta bancaria/Stripe
```

#### **1.2 Crear Producto en Lemon Squeezy**
```javascript
Producto: Lealta Pro - All-in-One Business Platform

Configuración:
- Nombre: "Lealta Pro"
- Descripción: "Sistema completo de gestión, fidelización y reservas 
  con IA para restaurantes y negocios"
- Tipo: Subscription (Recurrente)
- Precio Mensual: $299 USD
- Precio Anual: $2,690 USD (25% descuento)
- Trial: 14 días gratis (recomendado)
- Impuestos: Automático por región
```

#### **1.3 Configurar Webhooks**
```javascript
Webhooks necesarios:
✅ subscription_created    → Activar cuenta negocio
✅ subscription_updated    → Actualizar plan
✅ subscription_cancelled  → Pausar cuenta
✅ subscription_resumed    → Reactivar cuenta
✅ subscription_expired    → Bloquear acceso
✅ order_created          → Notificación nueva venta
✅ order_refunded         → Procesar reembolso
```

---

### 🎯 **FASE 2: INTEGRACIÓN TÉCNICA (Día 3-5)**

#### **2.1 Instalar Dependencies**
```bash
npm install @lemonsqueezy/lemonsqueezy.js
npm install @lemonsqueezy/paddle-js # Para checkout embebido
```

#### **2.2 Configurar Variables de Entorno**
```bash
# .env.local
LEMONSQUEEZY_API_KEY=your_api_key
LEMONSQUEEZY_STORE_ID=your_store_id
LEMONSQUEEZY_PRODUCT_ID=your_product_id
LEMONSQUEEZY_WEBHOOK_SECRET=your_webhook_secret
```

#### **2.3 Crear API Route para Webhooks**
```typescript
// src/app/api/webhooks/lemonsqueezy/route.ts
import { NextRequest, NextResponse } from 'next/server';
import crypto from 'crypto';
import { prisma } from '@/lib/prisma';

export async function POST(request: NextRequest) {
  try {
    const body = await request.text();
    const signature = request.headers.get('x-signature');

    // Verificar webhook signature
    const isValid = verifyWebhookSignature(body, signature);
    if (!isValid) {
      return NextResponse.json({ error: 'Invalid signature' }, { status: 401 });
    }

    const event = JSON.parse(body);
    const { meta, data } = event;

    console.log('🍋 Webhook recibido:', meta.event_name);

    switch (meta.event_name) {
      case 'subscription_created':
        await handleSubscriptionCreated(data);
        break;

      case 'subscription_updated':
        await handleSubscriptionUpdated(data);
        break;

      case 'subscription_cancelled':
        await handleSubscriptionCancelled(data);
        break;

      case 'subscription_expired':
        await handleSubscriptionExpired(data);
        break;

      case 'order_created':
        await handleOrderCreated(data);
        break;

      default:
        console.log('Evento no manejado:', meta.event_name);
    }

    return NextResponse.json({ received: true });
  } catch (error) {
    console.error('Error procesando webhook:', error);
    return NextResponse.json({ error: 'Webhook error' }, { status: 500 });
  }
}

function verifyWebhookSignature(body: string, signature: string | null): boolean {
  if (!signature) return false;

  const secret = process.env.LEMONSQUEEZY_WEBHOOK_SECRET!;
  const hash = crypto
    .createHmac('sha256', secret)
    .update(body)
    .digest('hex');

  return hash === signature;
}

async function handleSubscriptionCreated(data: any) {
  const { attributes, id } = data;
  const customerId = attributes.customer_id;
  const businessId = attributes.custom_data?.businessId;

  // Actualizar base de datos
  await prisma.business.update({
    where: { id: businessId },
    data: {
      subscriptionStatus: 'ACTIVE',
      subscriptionId: id,
      customerId: customerId,
      plan: 'PRO',
      subscriptionStartDate: new Date(attributes.created_at),
      subscriptionEndDate: new Date(attributes.renews_at),
    },
  });

  console.log('✅ Suscripción activada para negocio:', businessId);
}

async function handleSubscriptionUpdated(data: any) {
  const { attributes, id } = data;
  
  await prisma.business.update({
    where: { subscriptionId: id },
    data: {
      subscriptionStatus: attributes.status.toUpperCase(),
      subscriptionEndDate: new Date(attributes.renews_at),
    },
  });
}

async function handleSubscriptionCancelled(data: any) {
  const { id } = data;
  
  await prisma.business.update({
    where: { subscriptionId: id },
    data: {
      subscriptionStatus: 'CANCELLED',
      // Dar 30 días de gracia antes de desactivar
      subscriptionGracePeriodEnd: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),
    },
  });
}

async function handleSubscriptionExpired(data: any) {
  const { id } = data;
  
  await prisma.business.update({
    where: { subscriptionId: id },
    data: {
      subscriptionStatus: 'EXPIRED',
      isActive: false,
    },
  });
}

async function handleOrderCreated(data: any) {
  // Log para analytics
  console.log('🎉 Nueva venta:', data.attributes.total_formatted);
  
  // Enviar notificación a Slack/Email
  // await notifyNewSale(data);
}
```

#### **2.4 Actualizar Schema Prisma**
```prisma
// prisma/schema.prisma

model Business {
  id               String   @id @default(cuid())
  name             String
  slug             String   @unique
  
  // ... campos existentes ...
  
  // 🍋 Lemon Squeezy Integration
  subscriptionStatus      SubscriptionStatus @default(TRIAL)
  subscriptionId          String?   @unique
  customerId              String?
  plan                    String?   @default("TRIAL")
  subscriptionStartDate   DateTime?
  subscriptionEndDate     DateTime?
  subscriptionGracePeriodEnd DateTime?
  
  // Features enabled (para future-proofing)
  enabledModules          String[]  @default(["all"])
  
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

enum SubscriptionStatus {
  TRIAL
  ACTIVE
  PAST_DUE
  CANCELLED
  EXPIRED
  PAUSED
}
```

#### **2.5 Crear Página de Pricing**
```typescript
// src/app/pricing/page.tsx
'use client';

import { useState } from 'react';
import { Check, Zap } from 'lucide-react';
import { Button } from '@/components/ui/button';

export default function PricingPage() {
  const [billingCycle, setBillingCycle] = useState<'monthly' | 'yearly'>('monthly');

  const handleCheckout = async (cycle: 'monthly' | 'yearly') => {
    const checkoutUrl = cycle === 'monthly' 
      ? process.env.NEXT_PUBLIC_LEMONSQUEEZY_CHECKOUT_MONTHLY
      : process.env.NEXT_PUBLIC_LEMONSQUEEZY_CHECKOUT_YEARLY;

    // Redirigir a Lemon Squeezy checkout
    window.location.href = checkoutUrl!;
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 py-20">
      <div className="max-w-7xl mx-auto px-4">
        {/* Header */}
        <div className="text-center mb-16">
          <h1 className="text-5xl font-bold text-white mb-4">
            Simple, Transparente, Todo Incluido
          </h1>
          <p className="text-xl text-gray-300 mb-8">
            Un solo plan. Todos los módulos. Sin sorpresas.
          </p>

          {/* Toggle Billing */}
          <div className="flex items-center justify-center gap-4">
            <span className={`text-lg ${billingCycle === 'monthly' ? 'text-white font-semibold' : 'text-gray-400'}`}>
              Mensual
            </span>
            <button
              onClick={() => setBillingCycle(billingCycle === 'monthly' ? 'yearly' : 'monthly')}
              className="relative w-16 h-8 bg-purple-600 rounded-full transition-colors"
            >
              <div className={`absolute top-1 w-6 h-6 bg-white rounded-full transition-transform ${
                billingCycle === 'yearly' ? 'translate-x-9' : 'translate-x-1'
              }`} />
            </button>
            <span className={`text-lg ${billingCycle === 'yearly' ? 'text-white font-semibold' : 'text-gray-400'}`}>
              Anual
              <span className="ml-2 px-2 py-1 bg-green-500 text-white text-xs rounded-full">
                Ahorra 25%
              </span>
            </span>
          </div>
        </div>

        {/* Pricing Card */}
        <div className="max-w-2xl mx-auto">
          <div className="bg-white rounded-2xl shadow-2xl p-8 border-4 border-purple-500">
            {/* Badge */}
            <div className="flex items-center justify-between mb-6">
              <div>
                <h2 className="text-3xl font-bold text-gray-900">Lealta Pro</h2>
                <p className="text-gray-600">Todo lo que necesitas para crecer</p>
              </div>
              <div className="bg-purple-100 text-purple-700 px-4 py-2 rounded-lg font-semibold">
                <Zap className="inline h-5 w-5 mr-1" />
                Popular
              </div>
            </div>

            {/* Price */}
            <div className="mb-8">
              <div className="flex items-baseline gap-2">
                <span className="text-6xl font-bold text-gray-900">
                  ${billingCycle === 'monthly' ? '299' : '224'}
                </span>
                <span className="text-2xl text-gray-600">/mes</span>
              </div>
              {billingCycle === 'yearly' && (
                <p className="text-green-600 font-semibold mt-2">
                  $2,690 facturado anualmente - Ahorras $898/año
                </p>
              )}
            </div>

            {/* Features */}
            <div className="space-y-4 mb-8">
              <h3 className="font-bold text-lg text-gray-900 mb-4">Todo incluido:</h3>
              
              <FeatureItem text="15+ Módulos integrados (CRM, POS, Reservas IA, Analytics)" />
              <FeatureItem text="Usuarios staff ilimitados" />
              <FeatureItem text="Clientes ilimitados" />
              <FeatureItem text="Transacciones ilimitadas" />
              <FeatureItem text="Almacenamiento 50GB" />
              <FeatureItem text="Portal Cliente personalizado (PWA)" />
              <FeatureItem text="Sistema de Fidelización completo" />
              <FeatureItem text="Reservas con IA (Gemini 2.0)" />
              <FeatureItem text="POS con OCR automático" />
              <FeatureItem text="Analytics en tiempo real" />
              <FeatureItem text="Notificaciones Push" />
              <FeatureItem text="QR Code Management" />
              <FeatureItem text="Soporte prioritario (24-48h)" />
              <FeatureItem text="Training inicial incluido" />
              <FeatureItem text="Updates automáticos" />
              <FeatureItem text="Backup diario" />
              <FeatureItem text="SSL y seguridad incluida" />
              <FeatureItem text="Dominio personalizado" />
            </div>

            {/* Bonos */}
            <div className="bg-purple-50 rounded-lg p-6 mb-8">
              <h4 className="font-bold text-purple-900 mb-3 flex items-center gap-2">
                🎁 Bonos Incluidos (Valor $500+)
              </h4>
              <ul className="space-y-2 text-purple-800">
                <li>✨ Setup inicial completamente gratis</li>
                <li>🎨 Personalización de branding incluida</li>
                <li>📦 Migración de datos (si aplica)</li>
                <li>🛡️ 30 días garantía de devolución</li>
              </ul>
            </div>

            {/* CTA Button */}
            <Button
              onClick={() => handleCheckout(billingCycle)}
              className="w-full bg-purple-600 hover:bg-purple-700 text-white text-lg py-6 rounded-xl"
            >
              Comenzar ahora - 14 días gratis
            </Button>

            <p className="text-center text-sm text-gray-500 mt-4">
              No requiere tarjeta de crédito para el trial
            </p>
          </div>
        </div>

        {/* Comparativa Valor */}
        <div className="max-w-4xl mx-auto mt-16">
          <div className="bg-white/10 backdrop-blur-lg rounded-xl p-8">
            <h3 className="text-2xl font-bold text-white text-center mb-6">
              💰 Comparativa de Valor
            </h3>
            <div className="grid md:grid-cols-2 gap-8 text-white">
              <div>
                <h4 className="font-semibold mb-4 text-red-300">❌ Soluciones Separadas:</h4>
                <ul className="space-y-2 text-sm">
                  <li>Square POS: $165/mes</li>
                  <li>OpenTable: $249/mes</li>
                  <li>Loyalty Lion: $399/mes</li>
                  <li>Zendesk: $115/mes</li>
                  <li>Analytics: $99/mes</li>
                  <li className="pt-2 border-t border-white/20 font-bold text-lg">
                    Total: $1,027/mes
                  </li>
                </ul>
              </div>
              <div>
                <h4 className="font-semibold mb-4 text-green-300">✅ Lealta Pro:</h4>
                <ul className="space-y-2 text-sm">
                  <li>✅ Todo lo anterior</li>
                  <li>✅ + IA integrada</li>
                  <li>✅ + Portal cliente</li>
                  <li>✅ + QR Management</li>
                  <li>✅ + Soporte incluido</li>
                  <li className="pt-2 border-t border-white/20 font-bold text-lg text-green-400">
                    Total: $299/mes
                  </li>
                </ul>
              </div>
            </div>
            <p className="text-center text-2xl font-bold text-green-400 mt-6">
              Ahorras $728/mes (71% de descuento)
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}

function FeatureItem({ text }: { text: string }) {
  return (
    <div className="flex items-start gap-3">
      <Check className="h-6 w-6 text-green-500 flex-shrink-0" />
      <span className="text-gray-700">{text}</span>
    </div>
  );
}
```

---

### 🎯 **FASE 3: MIDDLEWARE DE SUSCRIPCIÓN (Día 6-7)**

#### **3.1 Crear Middleware de Validación**
```typescript
// src/middleware/subscriptionGuard.ts
import { NextRequest, NextResponse } from 'next/server';
import { prisma } from '@/lib/prisma';

export async function subscriptionGuard(
  request: NextRequest,
  businessId: string
): Promise<NextResponse | null> {
  try {
    const business = await prisma.business.findUnique({
      where: { id: businessId },
      select: {
        subscriptionStatus: true,
        subscriptionEndDate: true,
        subscriptionGracePeriodEnd: true,
      },
    });

    if (!business) {
      return NextResponse.json(
        { error: 'Negocio no encontrado' },
        { status: 404 }
      );
    }

    // Verificar estado de suscripción
    const now = new Date();

    switch (business.subscriptionStatus) {
      case 'TRIAL':
        // Verificar si trial expiró
        if (business.subscriptionEndDate && business.subscriptionEndDate < now) {
          return NextResponse.json(
            {
              error: 'Trial expirado',
              message: 'Tu período de prueba ha terminado. Por favor suscríbete para continuar.',
              redirectTo: '/pricing',
            },
            { status: 402 }
          );
        }
        break;

      case 'ACTIVE':
        // Todo OK
        break;

      case 'PAST_DUE':
        // Mostrar banner pero permitir uso limitado
        console.warn('⚠️ Suscripción vencida para:', businessId);
        break;

      case 'CANCELLED':
        // Verificar si está en grace period
        if (business.subscriptionGracePeriodEnd && business.subscriptionGracePeriodEnd < now) {
          return NextResponse.json(
            {
              error: 'Suscripción cancelada',
              message: 'Tu suscripción ha sido cancelada. Renueva para continuar.',
              redirectTo: '/pricing',
            },
            { status: 402 }
          );
        }
        break;

      case 'EXPIRED':
        return NextResponse.json(
          {
            error: 'Suscripción expirada',
            message: 'Tu suscripción ha expirado. Por favor renueva tu plan.',
            redirectTo: '/pricing',
          },
          { status: 402 }
        );

      default:
        break;
    }

    return null; // No hay error, continuar
  } catch (error) {
    console.error('Error en subscriptionGuard:', error);
    return NextResponse.json(
      { error: 'Error validando suscripción' },
      { status: 500 }
    );
  }
}
```

#### **3.2 Integrar en APIs Críticas**
```typescript
// src/app/api/reservas/create/route.ts
import { subscriptionGuard } from '@/middleware/subscriptionGuard';

export async function POST(request: NextRequest) {
  return withAuth(request, async (session) => {
    // Validar suscripción
    const subscriptionError = await subscriptionGuard(request, session.businessId);
    if (subscriptionError) return subscriptionError;

    // Continuar con lógica normal...
  });
}
```

---

### 🎯 **FASE 4: DASHBOARD DE SUSCRIPCIÓN (Día 8-9)**

#### **4.1 Crear Página de Billing en Admin**
```typescript
// src/app/[businessId]/admin/billing/page.tsx
'use client';

import { useEffect, useState } from 'react';
import { CreditCard, Calendar, AlertCircle, CheckCircle } from 'lucide-react';
import { Button } from '@/components/ui/button';

interface SubscriptionData {
  status: string;
  plan: string;
  startDate: string;
  endDate: string;
  customerId: string;
}

export default function BillingPage({ params }: { params: { businessId: string } }) {
  const [subscription, setSubscription] = useState<SubscriptionData | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchSubscription();
  }, []);

  const fetchSubscription = async () => {
    try {
      const res = await fetch(`/api/business/${params.businessId}/subscription`);
      const data = await res.json();
      setSubscription(data.subscription);
    } catch (error) {
      console.error('Error fetching subscription:', error);
    } finally {
      setLoading(false);
    }
  };

  const handleManageBilling = () => {
    // Redirigir a Lemon Squeezy customer portal
    window.open(
      `https://app.lemonsqueezy.com/my-orders/customer-portal/${subscription?.customerId}`,
      '_blank'
    );
  };

  const getStatusBadge = (status: string) => {
    const badges = {
      ACTIVE: { text: 'Activa', className: 'bg-green-100 text-green-800', icon: CheckCircle },
      TRIAL: { text: 'Prueba', className: 'bg-blue-100 text-blue-800', icon: AlertCircle },
      CANCELLED: { text: 'Cancelada', className: 'bg-red-100 text-red-800', icon: AlertCircle },
      EXPIRED: { text: 'Expirada', className: 'bg-gray-100 text-gray-800', icon: AlertCircle },
      PAST_DUE: { text: 'Vencida', className: 'bg-yellow-100 text-yellow-800', icon: AlertCircle },
    };

    const badge = badges[status as keyof typeof badges] || badges.ACTIVE;
    const Icon = badge.icon;

    return (
      <span className={`px-3 py-1 rounded-full text-sm font-semibold inline-flex items-center gap-2 ${badge.className}`}>
        <Icon className="h-4 w-4" />
        {badge.text}
      </span>
    );
  };

  if (loading) {
    return <div className="p-8">Cargando...</div>;
  }

  return (
    <div className="max-w-4xl mx-auto p-8">
      <h1 className="text-3xl font-bold mb-8">Facturación y Suscripción</h1>

      {/* Subscription Status Card */}
      <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
        <div className="flex items-center justify-between mb-6">
          <div>
            <h2 className="text-xl font-semibold mb-2">Estado de Suscripción</h2>
            {getStatusBadge(subscription?.status || 'ACTIVE')}
          </div>
          <CreditCard className="h-12 w-12 text-purple-600" />
        </div>

        <div className="grid grid-cols-2 gap-6">
          <div>
            <p className="text-sm text-gray-600 mb-1">Plan Actual</p>
            <p className="text-lg font-semibold">{subscription?.plan || 'Lealta Pro'}</p>
          </div>
          <div>
            <p className="text-sm text-gray-600 mb-1">Precio</p>
            <p className="text-lg font-semibold">$299/mes</p>
          </div>
          <div>
            <p className="text-sm text-gray-600 mb-1">Fecha de Inicio</p>
            <p className="text-lg font-semibold">
              {subscription?.startDate ? new Date(subscription.startDate).toLocaleDateString() : '-'}
            </p>
          </div>
          <div>
            <p className="text-sm text-gray-600 mb-1 flex items-center gap-2">
              <Calendar className="h-4 w-4" />
              Próxima Renovación
            </p>
            <p className="text-lg font-semibold">
              {subscription?.endDate ? new Date(subscription.endDate).toLocaleDateString() : '-'}
            </p>
          </div>
        </div>

        <div className="mt-6 pt-6 border-t">
          <Button
            onClick={handleManageBilling}
            className="w-full bg-purple-600 hover:bg-purple-700"
          >
            Gestionar Suscripción
          </Button>
          <p className="text-xs text-gray-500 text-center mt-2">
            Actualiza tu método de pago, descarga facturas o cancela tu suscripción
          </p>
        </div>
      </div>

      {/* Features Included */}
      <div className="bg-gray-50 rounded-lg p-6">
        <h3 className="font-semibold mb-4">Incluido en tu plan:</h3>
        <div className="grid grid-cols-2 gap-3 text-sm">
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>15+ Módulos integrados</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Staff ilimitado</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Clientes ilimitados</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Soporte prioritario</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Updates automáticos</span>
          </div>
          <div className="flex items-center gap-2">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <span>Almacenamiento 50GB</span>
          </div>
        </div>
      </div>
    </div>
  );
}
```

---

## 🚀 **PLAN DE ACCIÓN COMPLETO**

### 📅 **Timeline de Implementación**

```
┌─────────────────────────────────────────────────────────────┐
│  DÍA 1-2: Setup Lemon Squeezy                              │
│  ✅ Crear cuenta                                           │
│  ✅ Configurar producto                                    │
│  ✅ Configurar webhooks                                    │
│  ✅ Obtener API keys                                       │
├─────────────────────────────────────────────────────────────┤
│  DÍA 3-5: Integración Backend                              │
│  ✅ Instalar dependencias                                  │
│  ✅ Crear webhook endpoint                                 │
│  ✅ Actualizar schema Prisma                               │
│  ✅ Migrar database                                        │
│  ✅ Testing webhooks                                       │
├─────────────────────────────────────────────────────────────┤
│  DÍA 6-7: Middleware & Guards                              │
│  ✅ Crear subscription guard                               │
│  ✅ Integrar en APIs críticas                              │
│  ✅ Testing de bloqueos                                    │
├─────────────────────────────────────────────────────────────┤
│  DÍA 8-9: Frontend                                         │
│  ✅ Página de pricing                                      │
│  ✅ Página de billing en admin                             │
│  ✅ Banners de suscripción                                 │
├─────────────────────────────────────────────────────────────┤
│  DÍA 10: Testing E2E                                       │
│  ✅ Test de checkout completo                              │
│  ✅ Test de webhooks                                       │
│  ✅ Test de restricciones                                  │
│  ✅ Test de renovación                                     │
├─────────────────────────────────────────────────────────────┤
│  DÍA 11-12: Deploy & Launch                               │
│  ✅ Deploy a producción                                    │
│  ✅ Configurar webhooks producción                         │
│  ✅ Testing en producción                                  │
│  ✅ Lanzamiento soft                                       │
└─────────────────────────────────────────────────────────────┘

⏱️ TOTAL: 12 días hasta lanzamiento
```

---

## 💼 **ESTRATEGIA DE GO-TO-MARKET**

### 🎯 **Primeros 5 Clientes (Mes 1-2)**

```
ESTRATEGIA: Lanzamiento con Early Adopters

1. 🎁 OFERTA LAUNCH (Primeros 5 clientes):
   • $199/mes por 3 meses (33% OFF)
   • Después $299/mes
   • Setup premium incluido
   • Migración de datos gratis
   • Onboarding 1-a-1 dedicado

2. 🎯 TARGET:
   • Restaurantes pequeños-medianos
   • Cafeterías con 2+ sucursales
   • Negocios con programa de fidelidad manual
   • Tu red cercana de contactos

3. 📢 CANALES:
   • LinkedIn outreach (tu perfil)
   • WhatsApp/Email directo
   • Referidos de primeros clientes
   • Demo en vivo (Zoom/presencial)
```

### 📈 **Clientes 6-15 (Mes 3-6)**

```
ESTRATEGIA: Crecimiento Orgánico

1. 💬 TESTIMONIOS:
   • Video testimonios clientes satisfechos
   • Case studies con métricas reales
   • Logos de clientes en landing

2. 📊 CONTENT MARKETING:
   • LinkedIn posts 2x/semana
   • Blog posts sobre fidelización
   • Tutoriales en YouTube

3. 🤝 PARTNERSHIPS:
   • Alianza con consultores de restaurantes
   • Referidos con comisión (10%)
   • Eventos locales de networking

4. 💰 INVERSIÓN MARKETING:
   • Google Ads: $200/mes
   • LinkedIn Ads: $200/mes
   • Contenido: $100/mes
```

---

## 📊 **MÉTRICAS DE ÉXITO**

```
┌──────────────────────────────────────────────────────────┐
│  MES 1-2:                                                │
│  🎯 5 clientes pagando ($1,495 MRR)                     │
│  📈 50 demos realizados                                 │
│  💰 Inversión: $500 marketing                           │
├──────────────────────────────────────────────────────────┤
│  MES 3-4:                                                │
│  🎯 8 clientes pagando ($2,392 MRR)                     │
│  📈 80 demos realizados                                 │
│  💰 Inversión: $800 marketing                           │
├──────────────────────────────────────────────────────────┤
│  MES 5-6:                                                │
│  🎯 12 clientes pagando ($3,588 MRR)                    │
│  📈 120 demos realizados                                │
│  💰 Inversión: $1,000 marketing                         │
├──────────────────────────────────────────────────────────┤
│  🏆 META 6 MESES:                                       │
│  ✅ 10-15 clientes                                      │
│  ✅ $3,000-4,500 MRR                                    │
│  ✅ Churn < 10%                                         │
│  ✅ NPS > 50                                            │
└──────────────────────────────────────────────────────────┘
```

---

## 🎯 **CONCLUSIÓN Y RECOMENDACIÓN FINAL**

### 💰 **Pricing Recomendado:**
```
✅ $299/mes (Pago Mensual)
✅ $2,690/año ($224/mes - 25% OFF Anual)
✅ 14 días trial gratis
✅ Sin setup fee
✅ Un solo plan (Lealta Pro)
```

### 📋 **Razones de este precio:**

1. **🎯 Psicológico**: $299 vs $300 hace gran diferencia
2. **💪 Valor percibido**: Comparado con $1,000+ en herramientas separadas
3. **💰 Margen saludable**: ~73% margen con 10 clientes
4. **🚀 Escalable**: Sostenible desde 5 hasta 50 clientes
5. **🤝 Accesible**: SMB pueden pagarlo sin aprobaciones complejas

### ⚡ **Next Steps Inmediatos:**

```bash
1. [ ] Crear cuenta Lemon Squeezy (1 hora)
2. [ ] Configurar producto y pricing (2 horas)
3. [ ] Implementar webhooks backend (1 día)
4. [ ] Crear página de pricing (1 día)
5. [ ] Testing completo (1 día)
6. [ ] Soft launch con 3 contactos cercanos (1 semana)
7. [ ] Ajustar según feedback (ongoing)
8. [ ] Full launch público (Día 14)
```

**¿Listo para implementar? Te ayudo con cualquier paso específico.** 🚀
